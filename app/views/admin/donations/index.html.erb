<div class="container mt-5">
  <h1 class="mb-4">Administración de Donaciones</h1>
  
  <% if @pending_count > 0 %>
    <div class="alert alert-warning mb-4">
      Hay <strong><%= @pending_count %></strong> donaciones pendientes de revisión.
    </div>
  <% else %>
    <div class="alert alert-success mb-4">
      No hay donaciones pendientes de revisión.
    </div>
  <% end %>

  <div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>Usuario</th>
              <th>Monto</th>
              <th>Tipo</th>
              <th>Estado</th>
              <th>Fecha</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <% @donations.each do |donation| %>
              <tr class="<%= 'table-secondary opacity-75' if donation.canceled? %>">
                <td><%= donation.user.email %></td>
                <td><%= number_to_currency(donation.amount) %></td>
                <td><%= donation.donation_type&.humanize || 'Money' %></td>
                <td>
                  <span class="badge bg-<%= donation_status_badge(donation.status) %>">
                    <%= donation.status&.humanize || 'Pendiente' %>
                  </span>
                </td>
                <td><%= l(donation.created_at, format: :short) %></td>
                <td>
                  <%= link_to 'Ver', admin_donation_path(donation), class: 'btn btn-sm btn-outline-primary' %>

                  <% if donation.pending? %>
                    <%= button_to 'Aprobar', 
                                  approve_admin_donation_path(donation), 
                                  method: :patch, 
                                  class: 'btn btn-sm btn-success' %>
                    <%= button_to 'Cancelar', 
                                  cancel_admin_donation_path(donation), 
                                  method: :patch, 
                                  class: 'btn btn-sm btn-danger' %>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>